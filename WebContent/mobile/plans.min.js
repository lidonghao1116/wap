!function(d){var b=function(c){service.loding.hide();c&&typeof c=="object"&&this.exd(c)};b.prototype.exd=function(f){if(d.isArray(f)){d.extend(true,service.packArray,f)}var c=this,g=service.packArray;return d.each(g,function(){var e=this;if(e===Object(e)){e.paytype=service.paytype[e.packtype];e.packvalue=parseFloat(e.packvalue).toFixed(2);c.ret(e,service.click)}})};b.prototype.ret=function(e,c){var j=d("<div/>",{"class":"cell"}),i=service.packtype;j.append('<div class="step-next"><button class="btn btn-primary-" type="button"><h3>'+(e.packtype==4?"<i></i>":("<font>"+e.currencysymbol+"</font>"+e.packvalue))+"</h3></button></div>");j.append('<p class="pice">'+i[e.packtype]+"</p>");if(service.loding.isUseLSProxy()){j.find("button").css("border","2px solid #ff7f66");j.find("h3").css("border","1px solid #ff7f66");j.find("p").css("color","#FF7F66")}c&&j.on("click","button",c);d(".pric_ls").append(j);return j};var a=d.fn.plans;d.plans=function(c){return new b(c)}}(Zepto);!function(f){var e="http://member3.ichano.cn/user",d="/wap";service={lang:"1",sessionid:"",cid:"",fback:"false",packArray:[],isLink:true,lite:false,reflsh:"",msg:"",packtype:{},paytype:{4:3,1:1,3:1},settings:{evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},point:{option:{},template:function(a,p){var r,q=service.settings;var o=new RegExp([q.interpolate.source,q.evaluate.source].join("|")+"|$","g");var n=0;var s="";a.replace(o,function(j,h,g,i){s+=a.slice(n,i);if(h){s+="'+\n((__t=("+h+"))==null?'':__t)+\n'"}if(g){s+="';\n"+g+"\n__p+='"}n=i+j.length;return j});s+="';\n";s="var __t,__p='"+s+"return __p;\n";try{r=new Function("obj",s)}catch(c){c.source=s;throw c}if(p){return r(p)}var b=function(g){return r.call(this,g)};b.source="function("+(q.variable||"obj")+"){\n"+s+"}";return b},html:['<div class="row head-point">','<div class="point-log"><img src="/wap/app_img/point_2x.png"><%=obj.surplus%>：<font><%=obj.point%></font></div>','<button class="btn btn-group pull_right" type="button"><%=obj.getpoint%></button>',"</div>",'<div class="row body-point">','<div class="span12">',"<span><%=obj.month%></span>",'<a data-type="m" class="pull_right"><%=obj.change%></a>',"</div>",'<div class="span12">',"<span><%=obj.date%></span>",'<a data-type="d" class="pull_right"><%=obj.change%></a>',"</div>","</div>",'<div class="row footer-point">',"<p><%=obj.explain%></p>","</div>"],init:function(a){service.url_analysis();var b=e+"/point/getpointforjsonp?sessionid="+service.sessionid;service.loadScript(d+"/mobile/files/lang.js",function(){var c=langage.point[service.lang];f("#loading").html(c.loading).show();f.ajax({type:"GET",url:b,dataType:"jsonp",jsonp:"callback",context:this,timeout:5000,success:function(h){c.point=h.desc;service.point.time(c)}})})},click:function(){var a=langage.point[service.lang]||new Object();f(".wrapper").css("overflow","hidden"),f("#exchange").css("width","100%").addClass("section");setTimeout(function(){location.href="point.html?sessionid="+service.sessionid+"&lang="+service.lang+"&device="+(service.isLink?"1":"0")},800)},time:function(a){setTimeout(function(){var b=service.point.template(service.point.html.join(""),a);f("#paper").html(b).css({"background-color":"#F5F0EC"});if(service.lang!="2"){f("#paper").find(".body-point").addClass("s15")}f("#loading").hide(),f("#exchange").hide(),f(".wrapper").css("overflow","");f("#paper").find(".body-point").on("click","a",service.point.change);f(".head-point").find("button").on("click",function(){service.active(this);if(!service.isLink){return CloudJsObject.getPoint()}return location.href="getpoint:{}"})},800)},change:function(b){service.active(this);var g=this.getAttribute("data-type"),a=1004,c=langage.point[service.lang].message.m;if(g==="d"){a=1009,c=langage.point[service.lang].message.d}if(!service.isLink){return CloudJsObject.requestPoint(a,c)}return location.href="iospackageinfo:"+JSON.stringify({packid:a,message:c,paytype:3})}},loding:{show:function(){if(this.isUseLSProxy()){f(".row.bg_0").css("background-color","#FCF1DF");f(".paper .head").css("color","#FF7F66");f(".re_falch p").css("color","#FF7F66")}this.pk=f('<div class="re_falch pk"></div>').append('<div id="escaping" class="escaping"></div><p>'+service.reflsh+"</p>");this.dl=f('<div class="re_falch dl"><img src="/wap/app_img/reflag_.gif"></div>');f(".pric_ls").append(this.pk)},isString:function(a){return"string"==typeof a},hide:function(){this.pk.remove();this.dl.remove()},trim:function(a){return this.isString(a)?a.replace(/^\s+|\s+$/g,""):""},isUseLSProxy:function(){var a=navigator.userAgent;if(a.indexOf("AppleWebKit")>-1){if(a.match(/\bMobile\/\d+/)==null){return false}if(a.match(/iPad/i)==null){return false}return true}return false}},url_analysis:function(){var a=this.get_query_args(location.href);for(var b in a){if(f.type(a[b])!=null){if(b=="device"&&a[b]=="0"){this.isLink=false}else{if(b=="lang"){this.lang=a[b]}}}}this.fback=a.fallback||"false";this.sessionid=a.sessionid;this.cid=a.cid},setVal:function(c,b,l,m,a){this.reflsh=c;this.msg=b;this.packtype={4:l,1:m,3:a}},setPage:function(){var a=this;switch(a.lang){case"1":a.setVal("加载中...","支付完成!","积分兑换","每月","每年");break;case"3":a.setVal("加載中...","支付完成!","積分兌換","每月","每年");break;default:a.setVal("Loading...","Buy Success!","Redeem","Monthly","Annually");break}a.loding.show();this.loadScript(d+"/mobile/files/lang.js",function(){var b=langage[service.lang];f("[data-text]").each(function(){var c=f(this).attr("data-text".toLowerCase());f(this).append(b[c])})})},init:function(){this.url_analysis(),this.setPage();if(this.fback==="true"){return this.okey()}var a=e+"/getproobjsweb?sessionid="+this.sessionid+"&cid="+this.cid;f.ajax({type:"GET",url:a,dataType:"jsonp",jsonp:"callback",context:this,timeout:5000,success:function(b){if(service.lite||b.code=="1004"){return service.loadScript(d+"/mobile/beta.min.js",function(){var g=f.beta(b.time)})}var h=b.desc.proobjs,c=0;if(f.isArray(h)){f.map(this.packtype,function(g,j){return f.each(h,function(){if(this.packtype==j){return service.packArray[c++]=this}})});this.isLink?this.link():f.plans({})}}})},kvHtml:function(b,a){langage&&f(a).html(service.point.template(b,langage[service.lang]))},loadScript:function(b,c){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=b,a.readyState?a.onreadystatechange=function(){("loaded"==a.readyState||"complete"==a.readyState)&&(a.onreadystatechange=null,c())}:a.onload=function(){c()};document.getElementsByTagName("head")[0].appendChild(a)},get_query_args:function(m){var o=new Object(),n=m.split("?"),c;if(n.length>=2){c=n[1].split("#"),(c.length>=2)&&(n[1]=c[0],service.lite=true);var p=n[1],b=p.split("&");for(var a in b){$item=b[a].split("=");o[$item[0]]=$item[1]}}return o},breakObj:function(a){var b=f(a).closest("div.cell").index();return service.packArray[b-1]},click:function(a){service.active(this);var b=service.breakObj(this);if(b.packtype=="4"){return service.point.click()}if(!service.isLink){return service.android(b)}service.ios(b)},android:function(a){var h=a.currencysymbol,b=a.packvalue,c=a.duration;CloudJsObject.requestNewOrder(a.paytype,a.packid,h.toString(),b.toString(),c.toString(),a.currency)},ios:function(a){location.href="iospackageinfo:"+JSON.stringify(a)},link:function(){var b=new Array(),a=this.packArray;for(it in a){if(a[it].packtype!="4"){b.push(a[it])}}location.href="loadinginfo:"+JSON.stringify(b)},fallback:function(){location.href="index.html?sessionid="+service.sessionid+"&lang="+service.lang+"&device="+(service.isLink?"1":"0")+"&fallback=true"},active:function(a){f(a).addClass("active");setTimeout(function(){f(a).removeClass("active")},500)},okey:function(){var b='<img src="/wap/app_img/icon_success_iphone.png">',a="<p>";if(this.loding.isUseLSProxy()){b='<img src="/wap/app_img/icon_success_iPad.png">';a='<p style="color: #FF7F66">'}f(".pric_ls").empty().append('<div class="okey">'+b+a+this.msg+"</p></div>")},set:function(a){f.plans(a)}}}(Zepto);